{"remainingRequest":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\src\\components\\HeaderSearch\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\src\\components\\HeaderSearch\\index.vue","mtime":1757035093000},{"path":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1759557068287},{"path":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1759557070186},{"path":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1759557068287},{"path":"D:\\02-WorkSpace\\02-Java\\sanguimall\\RuoYi-Vue-master\\ruoyi-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1759557064843}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRnVzZSBmcm9tICdmdXNlLmpzL2Rpc3QvZnVzZS5taW4uanMnDQppbXBvcnQgcGF0aCBmcm9tICdwYXRoJw0KaW1wb3J0IHsgaXNIdHRwIH0gZnJvbSAnQC91dGlscy92YWxpZGF0ZScNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnSGVhZGVyU2VhcmNoJywNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2VhcmNoOiAnJywNCiAgICAgIG9wdGlvbnM6IFtdLA0KICAgICAgc2VhcmNoUG9vbDogW10sDQogICAgICBhY3RpdmVJbmRleDogLTEsDQogICAgICBzaG93OiBmYWxzZSwNCiAgICAgIGZ1c2U6IHVuZGVmaW5lZA0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICB0aGVtZSgpIHsNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5zZXR0aW5ncy50aGVtZQ0KICAgIH0sDQogICAgcm91dGVzKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZGVmYXVsdFJvdXRlcw0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICByb3V0ZXMoKSB7DQogICAgICB0aGlzLnNlYXJjaFBvb2wgPSB0aGlzLmdlbmVyYXRlUm91dGVzKHRoaXMucm91dGVzKQ0KICAgIH0sDQogICAgc2VhcmNoUG9vbChsaXN0KSB7DQogICAgICB0aGlzLmluaXRGdXNlKGxpc3QpDQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBjbGljaygpIHsNCiAgICAgIHRoaXMuc2hvdyA9ICF0aGlzLnNob3cNCiAgICAgIGlmICh0aGlzLnNob3cpIHsNCiAgICAgICAgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuZm9jdXMoKQ0KICAgICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLnNlYXJjaFBvb2wNCiAgICAgIH0NCiAgICB9LA0KICAgIGNsb3NlKCkgew0KICAgICAgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuYmx1cigpDQogICAgICB0aGlzLnNlYXJjaCA9ICcnDQogICAgICB0aGlzLm9wdGlvbnMgPSBbXQ0KICAgICAgdGhpcy5zaG93ID0gZmFsc2UNCiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMQ0KICAgIH0sDQogICAgY2hhbmdlKHZhbCkgew0KICAgICAgY29uc3QgcGF0aCA9IHZhbC5wYXRoDQogICAgICBjb25zdCBxdWVyeSA9IHZhbC5xdWVyeQ0KICAgICAgaWYoaXNIdHRwKHZhbC5wYXRoKSkgew0KICAgICAgICAvLyBodHRwKHMpOi8vIOi3r+W+hOaWsOeql+WPo+aJk+W8gA0KICAgICAgICBjb25zdCBwaW5kZXggPSBwYXRoLmluZGV4T2YoImh0dHAiKQ0KICAgICAgICB3aW5kb3cub3BlbihwYXRoLnN1YnN0cihwaW5kZXgsIHBhdGgubGVuZ3RoKSwgIl9ibGFuayIpDQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAocXVlcnkpIHsNCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IHBhdGgsIHF1ZXJ5OiBKU09OLnBhcnNlKHF1ZXJ5KSB9KQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHBhdGgpDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHRoaXMuc2VhcmNoID0gJycNCiAgICAgIHRoaXMub3B0aW9ucyA9IFtdDQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHRoaXMuc2hvdyA9IGZhbHNlDQogICAgICB9KQ0KICAgIH0sDQogICAgaW5pdEZ1c2UobGlzdCkgew0KICAgICAgdGhpcy5mdXNlID0gbmV3IEZ1c2UobGlzdCwgew0KICAgICAgICBzaG91bGRTb3J0OiB0cnVlLA0KICAgICAgICB0aHJlc2hvbGQ6IDAuNCwNCiAgICAgICAgbG9jYXRpb246IDAsDQogICAgICAgIGRpc3RhbmNlOiAxMDAsDQogICAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSwNCiAgICAgICAga2V5czogW3sNCiAgICAgICAgICBuYW1lOiAndGl0bGUnLA0KICAgICAgICAgIHdlaWdodDogMC43DQogICAgICAgIH0sIHsNCiAgICAgICAgICBuYW1lOiAncGF0aCcsDQogICAgICAgICAgd2VpZ2h0OiAwLjMNCiAgICAgICAgfV0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyDQogICAgLy8gQW5kIGdlbmVyYXRlIHRoZSBpbnRlcm5hdGlvbmFsaXplZCB0aXRsZQ0KICAgIGdlbmVyYXRlUm91dGVzKHJvdXRlcywgYmFzZVBhdGggPSAnLycsIHByZWZpeFRpdGxlID0gW10pIHsNCiAgICAgIGxldCByZXMgPSBbXQ0KDQogICAgICBmb3IgKGNvbnN0IHJvdXRlciBvZiByb3V0ZXMpIHsNCiAgICAgICAgLy8gc2tpcCBoaWRkZW4gcm91dGVyDQogICAgICAgIGlmIChyb3V0ZXIuaGlkZGVuKSB7IGNvbnRpbnVlIH0NCg0KICAgICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICAgIHBhdGg6ICFpc0h0dHAocm91dGVyLnBhdGgpID8gcGF0aC5yZXNvbHZlKGJhc2VQYXRoLCByb3V0ZXIucGF0aCkgOiByb3V0ZXIucGF0aCwNCiAgICAgICAgICB0aXRsZTogWy4uLnByZWZpeFRpdGxlXSwNCiAgICAgICAgICBpY29uOiAnJw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHJvdXRlci5tZXRhICYmIHJvdXRlci5tZXRhLnRpdGxlKSB7DQogICAgICAgICAgZGF0YS50aXRsZSA9IFsuLi5kYXRhLnRpdGxlLCByb3V0ZXIubWV0YS50aXRsZV0NCiAgICAgICAgICBkYXRhLmljb24gPSByb3V0ZXIubWV0YS5pY29uDQoNCiAgICAgICAgICBpZiAocm91dGVyLnJlZGlyZWN0ICE9PSAnbm9SZWRpcmVjdCcpIHsNCiAgICAgICAgICAgIC8vIG9ubHkgcHVzaCB0aGUgcm91dGVzIHdpdGggdGl0bGUNCiAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogbmVlZCB0byBleGNsdWRlIHBhcmVudCByb3V0ZXIgd2l0aG91dCByZWRpcmVjdA0KICAgICAgICAgICAgcmVzLnB1c2goZGF0YSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAocm91dGVyLnF1ZXJ5KSB7DQogICAgICAgICAgZGF0YS5xdWVyeSA9IHJvdXRlci5xdWVyeQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gcmVjdXJzaXZlIGNoaWxkIHJvdXRlcw0KICAgICAgICBpZiAocm91dGVyLmNoaWxkcmVuKSB7DQogICAgICAgICAgY29uc3QgdGVtcFJvdXRlcyA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXMocm91dGVyLmNoaWxkcmVuLCBkYXRhLnBhdGgsIGRhdGEudGl0bGUpDQogICAgICAgICAgaWYgKHRlbXBSb3V0ZXMubGVuZ3RoID49IDEpIHsNCiAgICAgICAgICAgIHJlcyA9IFsuLi5yZXMsIC4uLnRlbXBSb3V0ZXNdDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gcmVzDQogICAgfSwNCiAgICBxdWVyeVNlYXJjaChxdWVyeSkgew0KICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IC0xDQogICAgICBpZiAocXVlcnkgIT09ICcnKSB7DQogICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuZnVzZS5zZWFyY2gocXVlcnkpLm1hcCgoaXRlbSkgPT4gaXRlbS5pdGVtKSA/PyB0aGlzLnNlYXJjaFBvb2wNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuc2VhcmNoUG9vbA0KICAgICAgfQ0KICAgIH0sDQogICAgYWN0aXZlU3R5bGUoaW5kZXgpIHsNCiAgICAgIGlmIChpbmRleCAhPT0gdGhpcy5hY3RpdmVJbmRleCkgcmV0dXJuIHt9DQogICAgICByZXR1cm4gew0KICAgICAgICAiYmFja2dyb3VuZC1jb2xvciI6IHRoaXMudGhlbWUsDQogICAgICAgICJjb2xvciI6ICIjZmZmIg0KICAgICAgfQ0KICAgIH0sDQogICAgbmF2aWdhdGVSZXN1bHQoZGlyZWN0aW9uKSB7DQogICAgICBpZiAoZGlyZWN0aW9uID09PSAidXAiKSB7DQogICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLmFjdGl2ZUluZGV4IDw9IDAgPyB0aGlzLm9wdGlvbnMubGVuZ3RoIC0gMSA6IHRoaXMuYWN0aXZlSW5kZXggLSAxDQogICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gImRvd24iKSB7DQogICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLmFjdGl2ZUluZGV4ID49IHRoaXMub3B0aW9ucy5sZW5ndGggLSAxID8gMCA6IHRoaXMuYWN0aXZlSW5kZXggKyAxDQogICAgICB9DQogICAgfSwNCiAgICBzZWxlY3RBY3RpdmVSZXN1bHQoKSB7DQogICAgICBpZiAodGhpcy5vcHRpb25zLmxlbmd0aCA+IDAgJiYgdGhpcy5hY3RpdmVJbmRleCA+PSAwKSB7DQogICAgICAgIHRoaXMuY2hhbmdlKHRoaXMub3B0aW9uc1t0aGlzLmFjdGl2ZUluZGV4XSkNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\r\n  <div class=\"header-search\">\r\n    <svg-icon class-name=\"search-icon\" icon-class=\"search\" @click.stop=\"click\" />\r\n    <el-dialog\r\n      :visible.sync=\"show\"\r\n      width=\"600px\"\r\n      @close=\"close\"\r\n      :show-close=\"false\"\r\n      append-to-body\r\n    >\r\n      <el-input\r\n        v-model=\"search\"\r\n        ref=\"headerSearchSelectRef\"\r\n        size=\"large\"\r\n        @input=\"querySearch\"\r\n        prefix-icon=\"el-icon-search\"\r\n        placeholder=\"菜单搜索，支持标题、URL模糊查询\"\r\n        clearable\r\n        @keyup.enter.native=\"selectActiveResult\"\r\n        @keydown.up.native=\"navigateResult('up')\"\r\n        @keydown.down.native=\"navigateResult('down')\"\r\n      >\r\n      </el-input>\r\n      <el-scrollbar wrap-class=\"right-scrollbar-wrapper\">\r\n        <div class=\"result-wrap\">\r\n          <div class=\"search-item\" v-for=\"(item, index) in options\" :key=\"item.path\" :style=\"activeStyle(index)\" @mouseenter=\"activeIndex = index\" @mouseleave=\"activeIndex = -1\">\r\n            <div class=\"left\">\r\n              <svg-icon class=\"menu-icon\" :icon-class=\"item.icon\" />\r\n            </div>\r\n            <div class=\"search-info\" @click=\"change(item)\">\r\n              <div class=\"menu-title\">\r\n                {{ item.title.join(\" / \") }}\r\n              </div>\r\n              <div class=\"menu-path\">\r\n                {{ item.path }}\r\n              </div>\r\n            </div>\r\n            <svg-icon icon-class=\"enter\" v-show=\"index === activeIndex\"/>\r\n          </div>\r\n       </div>\r\n      </el-scrollbar>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Fuse from 'fuse.js/dist/fuse.min.js'\r\nimport path from 'path'\r\nimport { isHttp } from '@/utils/validate'\r\n\r\nexport default {\r\n  name: 'HeaderSearch',\r\n  data() {\r\n    return {\r\n      search: '',\r\n      options: [],\r\n      searchPool: [],\r\n      activeIndex: -1,\r\n      show: false,\r\n      fuse: undefined\r\n    }\r\n  },\r\n  computed: {\r\n    theme() {\r\n      return this.$store.state.settings.theme\r\n    },\r\n    routes() {\r\n      return this.$store.getters.defaultRoutes\r\n    }\r\n  },\r\n  watch: {\r\n    routes() {\r\n      this.searchPool = this.generateRoutes(this.routes)\r\n    },\r\n    searchPool(list) {\r\n      this.initFuse(list)\r\n    }\r\n  },\r\n  mounted() {\r\n    this.searchPool = this.generateRoutes(this.routes)\r\n  },\r\n  methods: {\r\n    click() {\r\n      this.show = !this.show\r\n      if (this.show) {\r\n        this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus()\r\n        this.options = this.searchPool\r\n      }\r\n    },\r\n    close() {\r\n      this.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur()\r\n      this.search = ''\r\n      this.options = []\r\n      this.show = false\r\n      this.activeIndex = -1\r\n    },\r\n    change(val) {\r\n      const path = val.path\r\n      const query = val.query\r\n      if(isHttp(val.path)) {\r\n        // http(s):// 路径新窗口打开\r\n        const pindex = path.indexOf(\"http\")\r\n        window.open(path.substr(pindex, path.length), \"_blank\")\r\n      } else {\r\n        if (query) {\r\n          this.$router.push({ path: path, query: JSON.parse(query) })\r\n        } else {\r\n          this.$router.push(path)\r\n        }\r\n      }\r\n      this.search = ''\r\n      this.options = []\r\n      this.$nextTick(() => {\r\n        this.show = false\r\n      })\r\n    },\r\n    initFuse(list) {\r\n      this.fuse = new Fuse(list, {\r\n        shouldSort: true,\r\n        threshold: 0.4,\r\n        location: 0,\r\n        distance: 100,\r\n        minMatchCharLength: 1,\r\n        keys: [{\r\n          name: 'title',\r\n          weight: 0.7\r\n        }, {\r\n          name: 'path',\r\n          weight: 0.3\r\n        }]\r\n      })\r\n    },\r\n    // Filter out the routes that can be displayed in the sidebar\r\n    // And generate the internationalized title\r\n    generateRoutes(routes, basePath = '/', prefixTitle = []) {\r\n      let res = []\r\n\r\n      for (const router of routes) {\r\n        // skip hidden router\r\n        if (router.hidden) { continue }\r\n\r\n        const data = {\r\n          path: !isHttp(router.path) ? path.resolve(basePath, router.path) : router.path,\r\n          title: [...prefixTitle],\r\n          icon: ''\r\n        }\r\n\r\n        if (router.meta && router.meta.title) {\r\n          data.title = [...data.title, router.meta.title]\r\n          data.icon = router.meta.icon\r\n\r\n          if (router.redirect !== 'noRedirect') {\r\n            // only push the routes with title\r\n            // special case: need to exclude parent router without redirect\r\n            res.push(data)\r\n          }\r\n        }\r\n\r\n        if (router.query) {\r\n          data.query = router.query\r\n        }\r\n\r\n        // recursive child routes\r\n        if (router.children) {\r\n          const tempRoutes = this.generateRoutes(router.children, data.path, data.title)\r\n          if (tempRoutes.length >= 1) {\r\n            res = [...res, ...tempRoutes]\r\n          }\r\n        }\r\n      }\r\n      return res\r\n    },\r\n    querySearch(query) {\r\n      this.activeIndex = -1\r\n      if (query !== '') {\r\n        this.options = this.fuse.search(query).map((item) => item.item) ?? this.searchPool\r\n      } else {\r\n        this.options = this.searchPool\r\n      }\r\n    },\r\n    activeStyle(index) {\r\n      if (index !== this.activeIndex) return {}\r\n      return {\r\n        \"background-color\": this.theme,\r\n        \"color\": \"#fff\"\r\n      }\r\n    },\r\n    navigateResult(direction) {\r\n      if (direction === \"up\") {\r\n        this.activeIndex = this.activeIndex <= 0 ? this.options.length - 1 : this.activeIndex - 1\r\n      } else if (direction === \"down\") {\r\n        this.activeIndex = this.activeIndex >= this.options.length - 1 ? 0 : this.activeIndex + 1\r\n      }\r\n    },\r\n    selectActiveResult() {\r\n      if (this.options.length > 0 && this.activeIndex >= 0) {\r\n        this.change(this.options[this.activeIndex])\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang='scss' scoped>\r\n::v-deep {\r\n  .el-dialog__header {\r\n    padding: 0 !important;\r\n  }\r\n}\r\n\r\n.header-search {\r\n  .search-icon {\r\n    cursor: pointer;\r\n    font-size: 18px;\r\n    vertical-align: middle;\r\n  }\r\n}\r\n\r\n.result-wrap {\r\n  height: 280px;\r\n  margin: 6px 0;\r\n\r\n  .search-item {\r\n    display: flex;\r\n    height: 48px;\r\n    align-items: center;\r\n    padding-right: 10px;\r\n\r\n    .left {\r\n      width: 60px;\r\n      text-align: center;\r\n\r\n      .menu-icon {\r\n        width: 18px;\r\n        height: 18px;\r\n      }\r\n    }\r\n\r\n    .search-info {\r\n      padding-left: 5px;\r\n      margin-top: 10px;\r\n      width: 100%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: flex-start;\r\n      flex: 1;\r\n\r\n      .menu-title,\r\n      .menu-path {\r\n        height: 20px;\r\n      }\r\n      .menu-path {\r\n        color: #ccc;\r\n        font-size: 10px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .search-item:hover {\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n\r\n"]}]}